id: akamai-pragma-header-vars

info:
  name: Akamai Pragma Header Variables Extraction
  author: byt3loss
  severity: info
  description: |
    Sends a request with the Akamai Pragma header to the target. 
    Searches for user defined variables that may reveal some useful information like the origin hostname.
  reference: 
    - https://techdocs.akamai.com/edge-diagnostics/docs/pragma-headers
  tags: akamai,pragma,recon

http:
  - method: GET
    path: 
      - "{{BaseURL}}"
    redirects: false
    headers:
      Pragma: "akamai-x-get-extracted-values"

    extractors:
      - type: regex
        part: header
        name: akamai_pair
        regex:
          - '(?i)name=(PMUSER_.+);\s*value=([^;\s]+)'
          #- '(?i)x-akamai-.+?:\s*name=(PMUSER_.+);\s*value=(.+)'